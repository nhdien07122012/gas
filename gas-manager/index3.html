<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Qu·∫£n l√Ω ti·ªÅn thu ƒëi·ªÉm gas</title>
<style>
  :root {
    --primary: #2c80ff;
    --primary-dark: #1a6de0;
    --secondary: #34c759;
    --light: #f8f9fa;
    --dark: #333;
    --gray: #6c757d;
    --border: #dee2e6;
    --shadow: 0 2px 10px rgba(0,0,0,0.08);
    --radius: 10px;
  }
  
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f5f7fa;
    color: var(--dark);
    line-height: 1.6;
    padding: 20px;
    min-height: 100vh;
  }
  
  .container {
    max-width: 900px;
    margin: 0 auto;
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow: hidden;
  }
  
  header {
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
    color: white;
    padding: 25px 30px;
    text-align: center;
  }
  
  header h1 {
    font-size: 1.8rem;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }
  
  header p {
    opacity: 0.9;
    font-size: 1rem;
  }
  
  .card {
    padding: 25px 30px;
    border-bottom: 1px solid var(--border);
  }
  
  .card:last-child {
    border-bottom: none;
  }
  
  .form-group {
    margin-bottom: 20px;
  }
  
  label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--dark);
  }
  
  input, select {
    width: 100%;
    padding: 14px 16px;
    border: 1.5px solid var(--border);
    border-radius: var(--radius);
    font-size: 1rem;
    transition: all 0.3s ease;
  }
  
  input:focus, select:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(44, 128, 255, 0.1);
  }
  
  .button-group {
    display: flex;
    gap: 15px;
    margin-top: 25px;
  }
  
  button {
    flex: 1;
    padding: 16px;
    border: none;
    border-radius: var(--radius);
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }
  
  .btn-primary {
    background-color: var(--primary);
    color: white;
  }
  
  .btn-primary:hover {
    background-color: var(--primary-dark);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(44, 128, 255, 0.3);
  }
  
  .btn-secondary {
    background-color: #f1f3f5;
    color: var(--dark);
  }
  
  .btn-secondary:hover {
    background-color: #e9ecef;
    transform: translateY(-2px);
  }
  
  .table-container {
    overflow-x: auto;
    margin-top: 10px;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 5px;
  }
  
  th {
    background-color: #f8f9fa;
    padding: 16px 12px;
    text-align: left;
    font-weight: 600;
    color: var(--dark);
    border-bottom: 2px solid var(--border);
  }
  
  td {
    padding: 14px 12px;
    border-bottom: 1px solid var(--border);
  }
  
  tr:last-child td {
    border-bottom: none;
  }
  
  tr:hover {
    background-color: #f8fafc;
  }
  
  .empty-state {
    text-align: center;
    padding: 40px 20px;
    color: var(--gray);
  }
  
  .empty-state p {
    margin-top: 10px;
  }
  
  /* Responsive styles */
  @media (max-width: 768px) {
    body {
      padding: 15px;
    }
    
    header {
      padding: 20px;
    }
    
    header h1 {
      font-size: 1.5rem;
    }
    
    .card {
      padding: 20px;
    }
    
    .button-group {
      flex-direction: column;
    }
    
    th, td {
      padding: 12px 8px;
      font-size: 0.9rem;
    }
    
    table {
      min-width: 500px;
    }
  }
  
  @media (max-width: 480px) {
    body {
      padding: 10px;
    }
    
    header {
      padding: 18px 15px;
    }
    
    header h1 {
      font-size: 1.3rem;
    }
    
    .card {
      padding: 18px 15px;
    }
    
    input, select {
      padding: 12px 14px;
    }
    
    button {
      padding: 14px;
    }
  }
  
  /* Animation */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .fade-in {
    animation: fadeIn 0.4s ease-out;
  }
</style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üìã Qu·∫£n l√Ω ti·ªÅn thu ƒëi·ªÉm gas</h1>
      <p>Theo d√µi v√† qu·∫£n l√Ω thu chi t·∫°i c√°c ƒëi·ªÉm gas</p>
    </header>
    
    <div class="card">
      <div class="form-group">
        <label for="chon_diem">Ch·ªçn ƒëi·ªÉm:</label>
        <select id="chon_diem" onchange="chonDiem()">
          <option value="">-- Ch·ªçn ƒëi·ªÉm --</option>
          <option value="new">‚ûï Th√™m ƒëi·ªÉm m·ªõi...</option>
        </select>
      </div>
      
      <div class="form-group">
        <label for="ten_diem">T√™n ƒëi·ªÉm:</label>
        <input id="ten_diem" placeholder="Nh·∫≠p t√™n ƒëi·ªÉm (n·∫øu th√™m m·ªõi)">
      </div>
      
      <div class="form-group">
        <label for="so_tien">S·ªë ti·ªÅn:</label>
        <input id="so_tien" type="number" placeholder="Nh·∫≠p s·ªë ti·ªÅn">
      </div>
      
      <div class="form-group">
        <label for="dia_chi">ƒê·ªãa ch·ªâ:</label>
        <input id="dia_chi" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">
      </div>
      
      <div class="button-group">
        <button class="btn-primary" onclick="guiDuLieu()">
          üíæ L∆∞u th√¥ng tin
        </button>
        <button class="btn-secondary" onclick="taiDuLieu()">
          üîÑ T·∫£i l·∫°i
        </button>
      </div>
    </div>
    
    <div class="card">
      <h2 style="margin-bottom: 15px;">üìä Danh s√°ch ƒëi·ªÉm gas</h2>
      <div class="table-container">
        <table id="bang">
          <thead>
            <tr>
              <th>T√™n ƒëi·ªÉm</th>
              <th>S·ªë ti·ªÅn</th>
              <th>ƒê·ªãa ch·ªâ</th>
            </tr>
          </thead>
          <tbody>
            <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
          </tbody>
        </table>
        <div id="empty-state" class="empty-state" style="display: none;">
          <h3>üì≠ Ch∆∞a c√≥ d·ªØ li·ªáu</h3>
          <p>H√£y th√™m ƒëi·ªÉm gas ƒë·∫ßu ti√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu qu·∫£n l√Ω</p>
        </div>
      </div>
    </div>
  </div>

<script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbwHchYfrwaVsHgqAVxwrcnNsZ8vOpSiWfihgLUoQtEHoMVcFLATUu2BSmDdyp2Rbi1rwQ/exec';
let cacheDiem = {};

async function guiDuLieu() {
  const ten_diem = document.getElementById('ten_diem').value || document.getElementById('chon_diem').value;
  const so_tien = document.getElementById('so_tien').value;
  const dia_chi = document.getElementById('dia_chi').value;

  if (!ten_diem || !so_tien || !dia_chi) {
    alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!');
    return;
  }

  const data = { ten_diem, so_tien, dia_chi };

  try {
    await fetch(scriptURL, {
      method: 'POST',
      body: JSON.stringify(data)
    });
    alert('‚úÖ ƒê√£ l∆∞u th√†nh c√¥ng!');
    document.getElementById('so_tien').value = '';
    taiDuLieu();
  } catch (error) {
    alert('‚ùå C√≥ l·ªói x·∫£y ra khi l∆∞u d·ªØ li·ªáu!');
    console.error(error);
  }
}

async function taiDuLieu() {
  try {
    const res = await fetch(scriptURL);
    const data = await res.json();
    const tbody = document.querySelector('#bang tbody');
    tbody.innerHTML = '';
    cacheDiem = {};

    const select = document.getElementById('chon_diem');
    select.innerHTML = '<option value="">-- Ch·ªçn ƒëi·ªÉm --</option><option value="new">‚ûï Th√™m ƒëi·ªÉm m·ªõi...</option>';

    // Hi·ªÉn th·ªã th√¥ng b√°o n·∫øu kh√¥ng c√≥ d·ªØ li·ªáu
    const emptyState = document.getElementById('empty-state');
    if (data.length === 0) {
      emptyState.style.display = 'block';
    } else {
      emptyState.style.display = 'none';
    }

    data.forEach(row => {
      const ten = row.ten_diem;
      const diachi = row.dia_chi;
      cacheDiem[ten] = diachi;

      // Th√™m v√†o b·∫£ng
      const tr = document.createElement('tr');
      tr.className = 'fade-in';
      tr.innerHTML = `
        <td>${ten}</td>
        <td>${formatCurrency(row.so_tien)}</td>
        <td>${diachi}</td>
      `;
      tbody.appendChild(tr);

      // Th√™m v√†o danh s√°ch ch·ªçn n·∫øu ch∆∞a c√≥
      if (![...select.options].some(o => o.value === ten)) {
        const opt = document.createElement('option');
        opt.value = ten;
        opt.textContent = ten;
        select.appendChild(opt);
      }
    });
  } catch (error) {
    alert('‚ùå C√≥ l·ªói x·∫£y ra khi t·∫£i d·ªØ li·ªáu!');
    console.error(error);
  }
}

function chonDiem() {
  const val = document.getElementById('chon_diem').value;
  const tenDiemInput = document.getElementById('ten_diem');
  const diaChiInput = document.getElementById('dia_chi');
  
  if (val === 'new' || val === '') {
    tenDiemInput.value = '';
    diaChiInput.value = '';
    tenDiemInput.disabled = false;
    tenDiemInput.placeholder = "Nh·∫≠p t√™n ƒëi·ªÉm (n·∫øu th√™m m·ªõi)";
  } else {
    tenDiemInput.value = val;
    diaChiInput.value = cacheDiem[val] || '';
    tenDiemInput.disabled = true;
    tenDiemInput.placeholder = "T√™n ƒëi·ªÉm ƒë√£ ch·ªçn";
  }
}

function formatCurrency(amount) {
  return new Intl.NumberFormat('vi-VN', {
    style: 'currency',
    currency: 'VND'
  }).format(amount);
}

// Kh·ªüi t·∫°o
document.addEventListener('DOMContentLoaded', function() {
  taiDuLieu();
});
</script>
</body>
</html>